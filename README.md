# PDDL formalization
:beginner: Classical Planning Assignment

RPG Domain
===================

You must work on this project **individually**. You are free to discuss
high-level design issues with the people in your class, but every aspect
of your actual formalisation must be entirely your own work.
Furthermore, there can be no textual similarities in the reports
generated by each group. Plagiarism, no matter the degree, will result
in forfeiture of the entire grade of this assignment.

For this assignment you will be using the open source implementation of
Graphplan available with the [JavaGP] library.
You can obtain a copy of this software from its SourceForge project
site, or you can download a more conveniently packaged version of the
software from our Moodle area. Your deliverables must be handed in via
Moodle using the correspondingly named upload rooms. At the end of this
assignment, you will upload **one zip file** containing the problem
specification files in the PDDL format, specifically:

-   one file named `rpg.pddl` containing the domain encoding;

-   three files containing the problems you formalised, named
    `pb#`, where `#` is the sequential number of your
    problem, e.g. `pb1.pddl`, `pb2.pddl`, and `pb3.pddl`;

-   the same number of files (with similar names) showing the traces
    created by [JavaGP] for the problems you created (e.g. `pb1.pddl` and `pb1.txt`); and

-   one report following the guidelines detailed below.

Overview
========

In this assignment you will formalise *RPG*, help a hero to get out of dungeon. 
The hero woke up in a dungeon full of monsters and traps (perhaps the party last night went wrong...) and needs your help to get out. Here are basic facts about the dungeon:

- The dungeon contains rooms that are connected by corridors (dungeon can thus be represented by undirected graph);
- Each room can be empty, or can have a monster in it, or can have a trap in it, or can have a sword in it; and
- One of the empty rooms is the “goal”: it has an exit, so the hero can escape;

The hero is lucky since he has full knowledge about the dungeon. But not that lucky, just after the hero leaves room s/he just visited, the room is destroyed and cannot be visited again.

The hero can perform the following actions, but only if s/he is alive!

- The hero can move to an adjacent room (connected by a corridor) that has not been destroyed (i.e., the hero has not already visited the room);
- Pickup the sword if present in the room the hero is currently in and the hero is empty handed;
- Destroy the sword that the hero currently holds. However, this can have unpleasant effects if done in a room with a trap or a monster;
- Disarm a trap, if there is a trap in the room the hero is in and the hero is empty-handed (does not hold a sword), then the hero can disarm it.

However, there are some (dangerous) constraints the hero has to consider:
- If the hero enters a room with a monster in it, s/he has to carry a sword (so the monster is afraid of him/her), otherwise the monster kills him/her. Notice that the hero is pacifist, so s/he cannot kill the monster;
- If the hero destroys the sword in a room with a monster in it, the monster kills him/her as well;
- The only action the hero can safely perform in a room with a trap in it is the “disarm a trap” action. Any other action (even moving away) triggers the trap which kills the hero.

Whenever we need to use automated tools to solve problems on our behalf,
we must provide a consistent specification of the *transition system* of
the underlying problem. If we specify the problem poorly, we jeopardise
the planner software ability to generate valid responses, leading to
false negatives and unnecessarily long waiting times for the planner at
best, or incorrect plans at worse. Thus, specifying the RPG domain in
PDDL gives you a chance to develop your skills in designing consistent
transition systems, helping you avoid bugs in the software you will
write in the future to handle all kinds of other processes.

Your assignment is to develop a domain file from the specification
above, and then model the situations depicted in the images below as
individual problem files.

Problem Instances
=================

Below are images of the problem instances that you need to model in
PDDL, once you are done making your domain file. The legend that
accompanies each image should be fairly self-explanatory; remember, you
must model corridors between rooms-rooms for the hero to move from
one to the other, and you can only move between connected rooms and visited each room only **once**. Problems are specified such that cells stand for rooms and edges between them represent corridors. “I” is an initial hero's position, “G” is hero's desired goal position, “S” indicates sword, “M” is a monster, and “T” stands for trap.

### Problem 1

![Problem 1](https://cloud.githubusercontent.com/assets/11094484/17340938/c0e712f0-58c8-11e6-895b-147f80574a76.png "Problem 1")
_Figure 1 - Problem 1_

### Problem 2
![Problem 2](https://cloud.githubusercontent.com/assets/11094484/17340937/c0e5d368-58c8-11e6-8dc9-98b7cf8ec0e6.png "Problem 2")
_Figure 2 - Problem 2_

### Problem 3
![Problem 3](https://cloud.githubusercontent.com/assets/11094484/17340256/c8ff76ba-58c5-11e6-8b6f-45d670623f9d.png "Problem 3")
_Figure 3 - Problem 3_

Grading
=======

In order to properly evaluate your work and thought process, you will
write a 2-page report in the AAAI two-column format explaining your
encoding and experiments. These guidelines are to be followed
**exactly**. **Reports that are less than two pages of actual content,
or not in format will receive 0 marks for the report criterion.** This
report will be included in the deliverables of **Part B** of the
assignment. [The formatting instructions are available at ShareLatex (AAAI Press)](https://pt.sharelatex.com/templates/journals/aaai-press). The report must have the following sections:

-   An introduction with your understanding of the problem domain,
    outlining the remainder of the paper;

-   Two domain formalisation sections explaining your approach to
    formalising the problems from Section [Problem Instances](#problem-instances).

-   One experimentation section where the performance of [JavaGP] is
    measured using your action formalisation for each of the domains, on
    multiple problems.

-   One conclusion section, where you will summarise your experience in
    encoding planning domains and discuss the performance of [JavaGP],
    and any limitations encountered in solving the problems you encoded.

Grading will consider elements of your encoding, experimentation
and reporting of the work done. The criteria, as well as their weight in
the final grade is as follows:

-   Domain Encoding (30%) — correctness of the domain encoding, in
    relation to the domain specification from Section [Overview](#overview);

-   Problem specifications (20%) — correctness of the problem
    specifications used for the experiments, particularly the initial
    state specification, as missing predicates here will jeopardise [JavaGP]’s
    ability to solve your problem;

-   Overall report readability (20%) — how accessible and coherent your
    explanation of your encoding is;

-   Experiments (30%) — how coherent the proposed experiments are in
    measuring the performance of [JavaGP],
    notice that this criteria is complementary to the one regarding
    problem specification.

Sample PDDL files
=================

We have provided two template PDDL files at [Domain Template](../pddl/domain-template.pddl) and [Problem Template](../pddl/problem-template.pddl) to get you started, these were obtained from the [myPDDL](https://github.com/Pold87/myPDDL "GitHub repository") sublime package.
We have also provided some sample files for other domains that you should look at before attempting to encode your own domain file and problem files.
These will give you an idea of the information that goes into each of those files, and the syntax.
You can also use these samples to test out the running of the planner, and to see what the output should look like.
-   [Blocks World Domain](http://moodle.pucrs.br/mod/resource/view.php?id=720129 "at Moodle")
-   [Gripper domain](http://moodle.pucrs.br/mod/resource/view.php?id=729356 "at Moodle")

Miscellaneous Advice
====================

Here are some lessons we learned in creating our own solution and
writing papers/reports:

-   [JavaGP] does not parse “or” conditions or effects. You need to specify conditions
    / effects as a list of predicates bound together by a single “and”.

-   As a first step, you should at least look at the sample domain and
    problem files given at the beginning of this specification.
    Additionally, here is a link to [PDDL domain and problem
    files](http://planning.cis.strath.ac.uk/competition/domains.html)
    (for scenarios different from the one you need to model in this
    project), from past iterations of the International Planning
    Competition (IPC).

-   The best way to figure out how to model a domain and associated
    problems is to look at these examples. If you feel the need for
    documentation, here is a paper that talks about the complete PDDL
    specification, with BNF specification at the end (Appendix A): [PDDL
    2.1
    Specification](http://www.public.asu.edu/~ktalamad/tmp/files/pddl21specs.pdf)

-   Using type predicates increases memory usage and slows down the
    creation of ground atoms but speeds up the (dominant) time to solve
    the problem (PDDL, however, allows typing of parameters);

-   Tables and graphs are a useful tool to show runtime performance of
    software, take a loot at [GnuPlot](http://www.gnuplot.info/ "GnuPlot is an excellent (and free) graph making software");

-   In order to evaluate the performance of a planning encoding, you
    need to specify problems with most of the parameters locked in, and
    measure runtime as one parameter increases (e.g. number of
    locations, number of containers, etc);

-   Pasting your entire domain specification (or problems) into the
    paper does not count as content (now you cannot say you were not
    warned);

-   Overly large figures used to simply fill space in the report are
    also not a good idea;

-   Reviewers have a more pleasant reading experience when papers are
    generated using <span style="font-variant:small-caps;">LaTeX</span>,
    it is very easy to spot the difference.

[JavaGP]: http://sourceforge.net/projects/emplan/ "Project page at Sourceforge"
